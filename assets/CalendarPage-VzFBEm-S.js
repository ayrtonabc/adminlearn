import{r as c,g as H,c as m,o as i,a as e,b as z,t as U,p as G,q as K,x as Q,f as V,m as F,F as _,y as L,d as P,e as q,h as W,k as X,l as Y,v as ee,w as te,s as B,i as R,j as J,S as ae,U as E}from"./index-Cz9qMU4q.js";import{M as oe}from"./MainLayout-CEmonEtD.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as le}from"./ModalComponent-BVjXJSti.js";import{a as Z}from"./index-C88pvD_q.js";const ne="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='16'%20height='16'%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2%2011.6C2%208.23969%202%206.55953%202.65396%205.27606C3.2292%204.14708%204.14708%203.2292%205.27606%202.65396C6.55953%202%208.23969%202%2011.6%202H20.4C23.7603%202%2025.4405%202%2026.7239%202.65396C27.8529%203.2292%2028.7708%204.14708%2029.346%205.27606C30%206.55953%2030%208.23969%2030%2011.6V20.4C30%2023.7603%2030%2025.4405%2029.346%2026.7239C28.7708%2027.8529%2027.8529%2028.7708%2026.7239%2029.346C25.4405%2030%2023.7603%2030%2020.4%2030H11.6C8.23969%2030%206.55953%2030%205.27606%2029.346C4.14708%2028.7708%203.2292%2027.8529%202.65396%2026.7239C2%2025.4405%202%2023.7603%202%2020.4V11.6Z'%20fill='%234087FC'/%3e%3cpath%20d='M8.26667%2010C7.56711%2010%207%2010.6396%207%2011.4286V18.3571C7%2020.369%208.44612%2022%2010.23%2022L17.7333%2021.9286C18.4329%2021.9286%2019%2021.289%2019%2020.5V13.5C19%2011.4881%2017.2839%2010%2015.5%2010L8.26667%2010Z'%20fill='white'/%3e%3cpath%20d='M20.7122%2012.7276C20.2596%2013.1752%2020%2013.8211%2020%2014.5V17.3993C20%2018.0782%2020.2596%2018.7242%2020.7122%2019.1717L23.5288%2021.6525C24.1019%2022.2191%2025%2021.7601%2025%2020.9005V11.1352C25%2010.2755%2024.1019%209.81654%2023.5288%2010.3832L20.7122%2012.7276Z'%20fill='white'/%3e%3c/svg%3e",re={class:"rounded-lg mb-1 border dark:border-gray-700 border-gray-400 w-full cursor-pointer"},ie={class:"flex gap-4 items-center w-full"},de={class:"w-full"},ue={class:"float-right text-xs text-gray-600 dark:text-gray-400"},me={class:"text-gray-800 dark:text-gray-200 text-sm"},ce={class:"text-gray-800 dark:text-gray-200 text-sm"},ve={class:"text-end w-[2rem] pe-2"},ge={class:"text-gray-600 dark:text-gray-400 text-xs p-4"},pe={class:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4 items-center p-4"},fe=["href"],xe={__name:"LessonItem",props:{lesson:Object},setup(d){const f=c(!1),x=c("auto"),S=c(null);return H(()=>{S.value!=null&&(x.value=`${S.value.clientHeight}px`,f.value=!0)}),(C,n)=>(i(),m("article",re,[e("div",ie,[e("div",{onClick:n[0]||(n[0]=w=>f.value=!f.value),class:"p-2 w-[calc(100%-2rem)] flex items-center"},[n[4]||(n[4]=z('<div class="me-4 ms-2"><div class="text-sky-500"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar3-event" viewBox="0 0 16 16"><path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857z"></path><path d="M12 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2"></path></svg></div></div>',1)),e("div",de,[e("small",ue,U(C.Utils.getDateTime(d.lesson.startdate).time),1),e("h3",me,"Lesson: "+U(d.lesson.name),1),e("h3",ce," Student: "+U(d.lesson.students.name),1)])]),e("div",ve,[e("button",{onClick:n[1]||(n[1]=w=>f.value=!f.value),class:G([{"rotate-180":!f.value},"dark:text-white text-black me-2 transition-transform"])},n[5]||(n[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-down",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"})],-1)]),2)])]),e("div",{class:"overflow-hidden transition-all",ref_key:"details",ref:S,style:K({height:f.value?"0px":x.value})},[e("p",ge,U(d.lesson.topic),1),e("div",pe,[e("a",{href:d.lesson.zoom_link,target:"_blank",class:"rounded transition-all col-span-2 md:col-span-1 main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"}," Open zoom ",8,fe),e("button",{onClick:n[2]||(n[2]=w=>C.$emit("edit",d.lesson)),class:"rounded transition-all main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"}," Edit "),e("button",{onClick:n[3]||(n[3]=w=>C.$emit("remove",d.lesson)),class:"rounded transition-all main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"}," Remove ")])],4)]))}},ye={class:"main mt-2"},be={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},he={class:"bg-gray-900 rounded-t-md text-white p-1 border border-gray-500"},we={class:"flex w-full justify-between px-2 py-2"},ke={class:"flex gap-x-4"},Ce=["value"],$e={class:"grid grid-cols-7 gap-1 text-sm text-gray-400 rounded-b-md border border-t-0 border-gray-500 p-2"},Me=["onClick"],Se={class:"min-h-[2rem] ms-1 grid grid-cols-1 sm:grid-cols-2 gap-0.5"},De=["onClick","title"],Ve={class:"mt-3 sm:mt-0"},Ue={class:"flex justify-center mt-4"},Te={key:0,class:"w-full"},_e={key:1,class:"min-h-[20rem] flex justify-center items-center"},je={__name:"CalendarItem",props:{day:Array,today:Date,student:Number},emits:["year","month","update","show","add","edit","remove"],setup(d,{emit:f}){const x=d,S=f,C=c([]),n=c(x.today.getDate()),w=c([]);c({show:!1});const $=c(x.today.getMonth()),y=c(x.today.getFullYear());Q(()=>x.day,()=>{j()});function h(D){C.value[D].day!==""&&(n.value=C.value[D].day,w.value=C.value[D].lessons)}function j(){C.value=x.day}function b(){x.today.getMonth()<11?$.value++:($.value=0,y.value++),o()}function t(){x.today.getMonth()!==0?$.value--:($.value=11,y.value--),o()}function o(){S("year",y.value),S("month",$.value),S("update")}return H(()=>{j()}),(D,v)=>(i(),m("div",ye,[e("div",be,[e("div",null,[e("div",he,[e("div",we,[(i(),m("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-left cursor-pointer text-gray-200",viewBox:"0 0 16 16"},v[3]||(v[3]=[e("path",{"fill-rule":"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"},null,-1)]))),e("div",ke,[V(e("select",{"onUpdate:modelValue":v[0]||(v[0]=u=>$.value=u),onChange:o,class:"bg-gray-900 border-none focus:outline-none text-white px-2 pe-6"},v[4]||(v[4]=[z('<option class="text-gray-800 px-2 py-1" value="0" data-v-74558218>January</option><option class="text-gray-800 px-2 py-1" value="1" data-v-74558218>February</option><option class="text-gray-800 px-2 py-1" value="2" data-v-74558218>March</option><option class="text-gray-800 px-2 py-1" value="3" data-v-74558218>April</option><option class="text-gray-800 px-2 py-1" value="4" data-v-74558218>May</option><option class="text-gray-800 px-2 py-1" value="5" data-v-74558218>June</option><option class="text-gray-800 px-2 py-1" value="6" data-v-74558218>July</option><option class="text-gray-800 px-2 py-1" value="7" data-v-74558218>August</option><option class="text-gray-800 px-2 py-1" value="8" data-v-74558218>September</option><option class="text-gray-800 px-2 py-1" value="9" data-v-74558218>October</option><option class="text-gray-800 px-2 py-1" value="10" data-v-74558218>November</option><option class="text-gray-800 px-2 py-1" value="11" data-v-74558218>December</option>',12)]),544),[[F,$.value]]),V(e("select",{"onUpdate:modelValue":v[1]||(v[1]=u=>y.value=u),onChange:o,class:"bg-gray-900 border-none focus:outline-none text-white p-2 pe-10"},[(i(),m(_,null,L(25,u=>e("option",{class:"text-gray-800 px-2 py-1",value:2e3+u,key:u},U(2e3+u),9,Ce)),64))],544),[[F,y.value]])]),(i(),m("svg",{onClick:b,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-right cursor-pointer text-gray-200",viewBox:"0 0 16 16"},v[5]||(v[5]=[e("path",{"fill-rule":"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"},null,-1)])))]),v[6]||(v[6]=z('<div class="weekdays flex justify-center items-center py-1" data-v-74558218><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Sun</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Mon</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Thu</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Wed</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Thu</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Fry</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Sat</div></div>',1))]),e("div",$e,[(i(!0),m(_,null,L(C.value,(u,O)=>(i(),m("div",{onClick:T=>h(O),key:O,class:G(["relative cursor-pointer rounded-md min-h-12 flex justify-between items-center p-2",{select:u.day==n.value&&!u.out,"main-gradient":D.Utils.sort(u.lessons).filter(T=>d.student==0||d.student==T.student_id).length>0}])},[e("div",{class:G(["",{"dark:text-gray-300":!u.out,"text-gray-700":!u.out,"dark:text-gray-500":u.out,"text-gray-400":u.out}])},U(u.day),3),e("div",Se,[(i(!0),m(_,null,L(D.Utils.sort(u.lessons),T=>(i(),m(_,null,[d.student==0||T.student_id==d.student?(i(),m("span",{onClick:I=>D.$emit("show",T),title:T.name,key:T.id},v[7]||(v[7]=[e("div",{class:"text-red-500"},[e("img",{src:ne})],-1)]),8,De)):P("",!0)],64))),256))])],10,Me))),128))])]),e("div",Ve,[e("button",{onClick:v[2]||(v[2]=u=>D.$emit("add",n.value)),class:"rounded transition-all main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"},v[8]||(v[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-person-plus-fill",viewBox:"0 0 16 16"},[e("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}),e("path",{"fill-rule":"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"})],-1),q(" Agregar ")])),e("div",Ue,[w.value.length>0?(i(),m("div",Te,[(i(!0),m(_,null,L(w.value,u=>(i(),W(xe,{lesson:u,key:u.id,onEdit:O=>D.$emit("edit",u),onRemove:O=>D.$emit("remove",u)},null,8,["lesson","onEdit","onRemove"]))),128))])):(i(),m("div",_e,v[9]||(v[9]=[z('<div class="text-center" data-v-74558218><svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="rgb(107, 114, 128)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-x m-auto" data-v-74558218><path d="m13.5 8.5-5 5" data-v-74558218></path><path d="m8.5 8.5 5 5" data-v-74558218></path><circle cx="11" cy="11" r="8" data-v-74558218></circle><path d="m21 21-4.3-4.3" data-v-74558218></path></svg><p class="text-center text-gray-500" data-v-74558218>There are no classes for this day.</p></div>',1)])))])])])]))}},Ee=se(je,[["__scopeId","data-v-74558218"]]),Le={class:"md:grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2"},Ne={class:"flex flex-col"},Be=["value"],Oe={class:"flex flex-col"},Ae=["value"],Fe={class:"flex flex-col"},Ye={class:"flex flex-col"},ze=["value"],He={class:"flex flex-col md:col-span-2"},Ie={class:"flex flex-col"},Re={class:"flex flex-col"},Je={class:"mt-5 flex items-center md:col-span-2"},Ge={__name:"LessonForm",props:{item:Object,students:Array,units:Array,topics:Array},emits:["send"],setup(d,{emit:f}){const x=d,S=f,C=c(!0);function n(b){S("send",b)}const w=c(new Date),$=c("08:00:00"),y=c(null),h=c(null);function j(){setTimeout(()=>{for(let b of x.topics)if(b.id==h.value){x.item.name=b.name,x.item.topic=b.topics;break}},200)}return H(()=>{let b=new Date;x.item.startdate!=null&&(b=new Date(x.item.startdate),w.value=`${b.getFullYear()}-${(b.getMonth()+1).toString().padStart(2,"0")}-${b.getDate().toString().padStart(2,"0")}`,console.log(w.value),$.value=`${b.getHours().toString().padStart(2,"0")}:${b.getMinutes().toString().padStart(2,"0")}:00`)}),(b,t)=>(i(),m("form",{id:"lesson-form",onSubmit:te(n,["prevent"]),class:"rounded-xl p-5 bg-[#aaaaaa] dark:bg-slate-900"},[e("div",Le,[e("div",Ne,[t[8]||(t[8]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"unit_id"},"Unit",-1)),V(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>y.value=o),"aria-label":"plan",id:"unit_id",onChange:j,class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(!0),m(_,null,L(d.units,o=>(i(),m("option",{value:o.id},U(o.name),9,Be))),256))],544),[[F,y.value]])]),e("div",Oe,[t[9]||(t[9]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"topic_id"},"Topic",-1)),V(e("select",{onChange:j,"aria-label":"plan",id:"topic_id","onUpdate:modelValue":t[1]||(t[1]=o=>h.value=o),class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(!0),m(_,null,L(d.topics.filter(o=>o.unit_id==y.value),o=>(i(),m("option",{value:o.id},U(o.name),9,Ae))),256))],544),[[F,h.value]])]),e("div",Fe,[t[10]||(t[10]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"name"},"Name",-1)),V(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>d.item.name=o),placeholder:"",type:"text","aria-label":"Name",name:"name",id:"name",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[Y,d.item.name]])]),e("div",Ye,[t[11]||(t[11]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"student_id"},"Student",-1)),V(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>d.item.student_id=o),"aria-label":"Student",name:"student_id",id:"student_id",class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(!0),m(_,null,L(d.students,o=>(i(),m("option",{value:o.id,key:o.id},U(o.name),9,ze))),128))],512),[[F,d.item.student_id]])]),e("div",He,[t[12]||(t[12]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"topic"},"Topic",-1)),V(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>d.item.topic=o),placeholder:"",type:"text","aria-label":"Topic",name:"topic",id:"topic",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[Y,d.item.topic]])]),e("div",Ie,[t[13]||(t[13]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"date"},"Date",-1)),V(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>w.value=o),placeholder:"",type:"date","aria-label":"Date",name:"date",id:"date",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[Y,w.value]])]),e("div",Re,[t[14]||(t[14]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"time"},"Time",-1)),V(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>$.value=o),placeholder:"",type:"time","aria-label":"Time",name:"time",id:"time",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[Y,$.value]])]),e("p",Je,[V(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>C.value=o),type:"checkbox",class:"mycheck",value:"yes",name:"notify",id:"notify"},null,512),[[ee,C.value]]),t[15]||(t[15]=e("label",{class:"ms-3 text-white font-[300] text-[1em]",for:"notify"},"Notify",-1))])]),X(b.$slots,"default")],32))}},Pe={class:"p-6"},Ze={class:"flex flex-col mb-2"},qe={value:0,key:0},We=["value"],Ke={key:0,class:"max-h-[70vh] overflow-auto custom-scroll"},Qe={class:"flex justify-end gap-2 p-4 w-full"},Xe=["disabled"],et={key:0,class:"spinner"},nt={__name:"CalendarPage",setup(d){const f=c(new Date),x=c(0),S=c(f.value.getMonth()),C=c(f.value.getFullYear()),n=c([]),w=c(0),$=c([]),y=c(!1),h=c({edit:!1,remove:!1,item:{}}),j=c([]),b=c([]);function t(a){const r=new Date;r.setDate(a),h.value.item={startdate:r.toISOString()},h.value.edit=!0}function o(a){h.value.item=JSON.parse(JSON.stringify(a)),h.value.edit=!0}async function D(a){const r=new FormData(a.target),s=h.value.item;y.value=!0;const k=r.has("notify"),p=Object.fromEntries(r.entries());p.startdate=new Date(`${p.date} ${p.time}`),delete p.date,delete p.time,delete p.notify;const M=new Date(p.startdate);M.setMinutes(M.getMinutes()-30),s.id==null?u(p.name,p.topic,p.startdate).then(l=>{p.zoom_link=l.join_url,p.meet_id=l.id,B.from("lessons").insert(p).select("*, students(*)").then(g=>{if(g.error)E.notify("Error",g.error.message,"error"),console.error("Error adding stuent:",g.error);else{const N=new Date(g.data[0].startdate);n.value[N.getDate()+Number(w.value)-1].lessons.push(g.data[0]),k&&v(g.data[0].students.email,g.data[0].students.name,g.data[0].topic,M,g.data[0].zoom_link),E.notify("Congratulations","The lesson has been added.")}y.value=!1}).catch(g=>{console.log(g),y.value=!1})}):B.from("lessons").update(p).eq("id",s.id).select("*, students(*)").then(l=>{if(l.error)console.error("Error updating lesson:",l.error),E.notify("Error",l.error.message,"error");else{for(let N of n.value)for(let A in N.lessons)if(N.lessons[A].id==s.id){N.lessons.splice(A,1);break}const g=new Date(l.data[0].startdate);n.value[g.getDate()+Number(w.value)-1].lessons.push(l.data[0]),k&&v(l.data[0].students.email,l.data[0].students.name,l.data[0].topic,M,l.data[0].zoom_link),E.notify("Congratulations","Lesson's data has been updated."),y.value=!1}}).catch(()=>{y.value=!1}),h.value={edit:!1,remove:!1,item:{}}}function v(a,r,s,k,p){return new Promise((M,l)=>{const g=new Date(k);g.setMinutes(g.getMinutes()+30);const N={email:a,subject:"Learn 24: New lesson in 30 minutes",greeting:"Hello "+r,introLines:["You have a new class with Learn 24",'The topic of the class is: "'+s+'"'],actionText:"OPEN ZOOM",actionUrl:p,displayableActionUrl:p,outroLines:["Your class starts in 30 minutes (at "+E.getDateTime(g.toISOString).time+")"],salutation:"Greetings",level:"success",datetime:new Date(k).toUTCString()};Z.post("https://email-api.msomnium.com/api/send-mail",N).then(A=>{M(A.data)}).catch(A=>{E.notify("Error","An error occurred while programming the email.","error"),l(A)})})}function u(a,r,s){return new Promise((k,p)=>{const M=new Date(s);M.setMinutes(M.getMinutes()+30);const l={name:a,topics:r,datetime:new Date(s).toUTCString()};Z.post("https://email-api.msomnium.com/api/create-meet",l).then(g=>{k(g.data)}).catch(g=>{E.notify("Error","An error occurred while programming the email.","error"),p(g)})})}function O(a){y.value=!0,ae.fire({title:"Confirm",text:"Are you sure you want to delete the lesson?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"}).then(r=>{r.isConfirmed&&B.from("lessons").delete().eq("id",a.id).then(()=>{E.notify("Congratulations","The lesson has been deleted"),y.value=!1;for(let s of n.value)for(let k in s.lessons)if(s.lessons[k].id==a.id){s.lessons.splice(k,1);break}}).catch(s=>{console.error("Error deleting the item:",s),y.value=!1})})}function T(){f.value.setMonth(S.value),f.value.setFullYear(C.value),I()}function I(){const a=new Date(f.value.getFullYear(),f.value.getMonth(),f.value.getDate()),r=a.getMonth()+1,s=a.getFullYear();B.from("lessons").select("*, students(*)").gte("startdate",`${s}-${r.toString().padStart(2,"0")}-01`).lt("startdate",`${s}-${(r+1).toString().padStart(2,"0")}-01`).then(k=>{if(k.error){console.error("Error fetching lessons:",k.error);return}n.value=[],a.setDate(1);const p=new Date(a.toISOString());p.setDate(0);for(let l=1;l<a.getDay()+1;l++)n.value.push({day:p.getDate()-l+1,out:!0});w.value=n.value.length,a.setMonth(a.getMonth()+1),a.setDate(0);for(let l=1;l<a.getDate()+1;l++)n.value.push({day:l,lessons:[],color:"text-black"});console.log(k);for(let l of k.data){const g=new Date(l.startdate);n.value[g.getDate()-1+w.value].lessons.push(l)}const M=new Date(a.toISOString());M.setDate(1),M.setMonth(a.getMonth()+1);for(let l=1;l<8-(a.getDay()+1);l++)n.value.push({day:M.getDate()+l-1,out:!0})}).catch(k=>{console.log("Error fetching lessons:",k)})}return H(()=>{I(),B.from("students").select("*").then(a=>{$.value=a.data}).catch(a=>{console.console.log(a)}),B.from("units").select("*").then(a=>{j.value=a.data}),B.from("topics").select("*").then(a=>{b.value=a.data})}),(a,r)=>(i(),W(oe,null,{default:R(()=>[e("div",Pe,[e("div",Ze,[V(e("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>x.value=s),"aria-label":"Student",name:"student_id",id:"student_id",class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(),m("option",qe,"All students")),(i(!0),m(_,null,L($.value,s=>(i(),m("option",{value:s.id,key:s.id},U(s.name),9,We))),128))],512),[[F,x.value]])]),J(Ee,{today:f.value,day:n.value,student:x.value,onUpdate:T,onAdd:t,onEdit:o,onRemove:O,onYear:r[1]||(r[1]=s=>C.value=s),onShow:r[2]||(r[2]=s=>a.details=s),onMonth:r[3]||(r[3]=s=>S.value=s)},null,8,["today","day","student"])]),J(le,{modelValue:h.value.edit,"onUpdate:modelValue":r[4]||(r[4]=s=>h.value.edit=s),title:h.value.item.id==null?"Add lesson":"Edit lesson",subtitle:h.value.item.id==null?"Complete the form to add a new lesson":"Complete the form to update lesson data"},{footer:R(()=>[e("div",Qe,[e("button",{form:"lesson-form",type:"submit",disabled:y.value,class:"duration-300 px-4 disabled:opacity-80 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[y.value?(i(),m("div",et)):P("",!0),r[5]||(r[5]=q(" Save "))],8,Xe)])]),default:R(()=>[h.value.edit?(i(),m("div",Ke,[J(Ge,{item:h.value.item,students:$.value,units:j.value,topics:b.value,onSend:D},null,8,["item","students","units","topics"])])):P("",!0)]),_:1},8,["modelValue","title","subtitle"])]),_:1}))}};export{nt as default};
