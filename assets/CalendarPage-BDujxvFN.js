import{r as c,g as F,c as m,o as i,a as e,b as A,t as U,p as R,q as P,x as W,f as D,l as _,F as T,y as j,d as Z,e as G,h as q,j as K,k as z,v as Q,w as X,s as N,i as H,n as I,S as ee,U as B}from"./index-md2zvfA6.js";import{M as te}from"./MainLayout-IdhIrvxk.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as oe}from"./ModalComponent-xI6T7MJE.js";import{a as le}from"./index-C88pvD_q.js";const se="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='16'%20height='16'%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2%2011.6C2%208.23969%202%206.55953%202.65396%205.27606C3.2292%204.14708%204.14708%203.2292%205.27606%202.65396C6.55953%202%208.23969%202%2011.6%202H20.4C23.7603%202%2025.4405%202%2026.7239%202.65396C27.8529%203.2292%2028.7708%204.14708%2029.346%205.27606C30%206.55953%2030%208.23969%2030%2011.6V20.4C30%2023.7603%2030%2025.4405%2029.346%2026.7239C28.7708%2027.8529%2027.8529%2028.7708%2026.7239%2029.346C25.4405%2030%2023.7603%2030%2020.4%2030H11.6C8.23969%2030%206.55953%2030%205.27606%2029.346C4.14708%2028.7708%203.2292%2027.8529%202.65396%2026.7239C2%2025.4405%202%2023.7603%202%2020.4V11.6Z'%20fill='%234087FC'/%3e%3cpath%20d='M8.26667%2010C7.56711%2010%207%2010.6396%207%2011.4286V18.3571C7%2020.369%208.44612%2022%2010.23%2022L17.7333%2021.9286C18.4329%2021.9286%2019%2021.289%2019%2020.5V13.5C19%2011.4881%2017.2839%2010%2015.5%2010L8.26667%2010Z'%20fill='white'/%3e%3cpath%20d='M20.7122%2012.7276C20.2596%2013.1752%2020%2013.8211%2020%2014.5V17.3993C20%2018.0782%2020.2596%2018.7242%2020.7122%2019.1717L23.5288%2021.6525C24.1019%2022.2191%2025%2021.7601%2025%2020.9005V11.1352C25%2010.2755%2024.1019%209.81654%2023.5288%2010.3832L20.7122%2012.7276Z'%20fill='white'/%3e%3c/svg%3e",ne={class:"rounded-lg mb-1 border dark:border-gray-700 border-gray-400 w-full cursor-pointer"},re={class:"flex gap-4 items-center w-full"},ie={class:"w-full"},de={class:"float-right text-xs text-gray-600 dark:text-gray-400"},ue={class:"text-gray-800 dark:text-gray-200 text-sm"},me={class:"text-gray-800 dark:text-gray-200 text-sm"},ce={class:"text-end w-[2rem] pe-2"},ve={class:"text-gray-600 dark:text-gray-400 text-xs p-4"},ge={class:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4 items-center p-4"},pe=["href"],fe={__name:"LessonItem",props:{lesson:Object},setup(r){const p=c(!1),f=c("auto"),$=c(null);return F(()=>{$.value!=null&&(f.value=`${$.value.clientHeight}px`,p.value=!0)}),(w,s)=>(i(),m("article",ne,[e("div",re,[e("div",{onClick:s[0]||(s[0]=b=>p.value=!p.value),class:"p-2 w-[calc(100%-2rem)] flex items-center"},[s[4]||(s[4]=A('<div class="me-4 ms-2"><div class="text-sky-500"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar3-event" viewBox="0 0 16 16"><path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857z"></path><path d="M12 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2"></path></svg></div></div>',1)),e("div",ie,[e("small",de,U(w.Utils.getDateTime(r.lesson.startdate).time),1),e("h3",ue,"Lesson: "+U(r.lesson.name),1),e("h3",me," Student: "+U(r.lesson.students.name),1)])]),e("div",ce,[e("button",{onClick:s[1]||(s[1]=b=>p.value=!p.value),class:R([{"rotate-180":!p.value},"dark:text-white text-black me-2 transition-transform"])},s[5]||(s[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-down",viewBox:"0 0 16 16"},[e("path",{"fill-rule":"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"})],-1)]),2)])]),e("div",{class:"overflow-hidden transition-all",ref_key:"details",ref:$,style:P({height:p.value?"0px":f.value})},[e("p",ve,U(r.lesson.topic),1),e("div",ge,[e("a",{href:r.lesson.zoom_link,target:"_blank",class:"rounded transition-all col-span-2 md:col-span-1 main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"}," Open zoom ",8,pe),e("button",{onClick:s[2]||(s[2]=b=>w.$emit("edit",r.lesson)),class:"rounded transition-all main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"}," Edit "),e("button",{onClick:s[3]||(s[3]=b=>w.$emit("remove",r.lesson)),class:"rounded transition-all main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"}," Remove ")])],4)]))}},xe={class:"main mt-2"},ye={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},be={class:"bg-gray-900 rounded-t-md text-white p-1 border border-gray-500"},he={class:"flex w-full justify-between px-2 py-2"},we={class:"flex gap-x-4"},ke=["value"],Ce={class:"grid grid-cols-7 gap-1 text-sm text-gray-400 rounded-b-md border border-t-0 border-gray-500 p-2"},$e=["onClick"],Me={class:"min-h-[2rem] ms-1 grid grid-cols-1 sm:grid-cols-2 gap-0.5"},Se=["onClick","title"],De={class:"mt-3 sm:mt-0"},Ve={class:"flex justify-center mt-4"},Ue={key:0,class:"w-full"},Te={key:1,class:"min-h-[20rem] flex justify-center items-center"},Le={__name:"CalendarItem",props:{day:Array,today:Date,student:Number},emits:["year","month","update","show","add","edit","remove"],setup(r,{emit:p}){const f=r,$=p,w=c([]),s=c(f.today.getDate()),b=c([]);c({show:!1});const k=c(f.today.getMonth()),g=c(f.today.getFullYear());W(()=>f.day,()=>{L()});function y(M){w.value[M].day!==""&&(s.value=w.value[M].day,b.value=w.value[M].lessons)}function L(){w.value=f.day}function x(){f.today.getMonth()<11?k.value++:(k.value=0,g.value++),o()}function t(){f.today.getMonth()!==0?k.value--:(k.value=11,g.value--),o()}function o(){$("year",g.value),$("month",k.value),$("update")}return F(()=>{L()}),(M,v)=>(i(),m("div",xe,[e("div",ye,[e("div",null,[e("div",be,[e("div",he,[(i(),m("svg",{onClick:t,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-left cursor-pointer text-gray-200",viewBox:"0 0 16 16"},v[3]||(v[3]=[e("path",{"fill-rule":"evenodd",d:"M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"},null,-1)]))),e("div",we,[D(e("select",{"onUpdate:modelValue":v[0]||(v[0]=d=>k.value=d),onChange:o,class:"bg-gray-900 border-none focus:outline-none text-white px-2 pe-6"},v[4]||(v[4]=[A('<option class="text-gray-800 px-2 py-1" value="0" data-v-74558218>January</option><option class="text-gray-800 px-2 py-1" value="1" data-v-74558218>February</option><option class="text-gray-800 px-2 py-1" value="2" data-v-74558218>March</option><option class="text-gray-800 px-2 py-1" value="3" data-v-74558218>April</option><option class="text-gray-800 px-2 py-1" value="4" data-v-74558218>May</option><option class="text-gray-800 px-2 py-1" value="5" data-v-74558218>June</option><option class="text-gray-800 px-2 py-1" value="6" data-v-74558218>July</option><option class="text-gray-800 px-2 py-1" value="7" data-v-74558218>August</option><option class="text-gray-800 px-2 py-1" value="8" data-v-74558218>September</option><option class="text-gray-800 px-2 py-1" value="9" data-v-74558218>October</option><option class="text-gray-800 px-2 py-1" value="10" data-v-74558218>November</option><option class="text-gray-800 px-2 py-1" value="11" data-v-74558218>December</option>',12)]),544),[[_,k.value]]),D(e("select",{"onUpdate:modelValue":v[1]||(v[1]=d=>g.value=d),onChange:o,class:"bg-gray-900 border-none focus:outline-none text-white p-2 pe-10"},[(i(),m(T,null,j(25,d=>e("option",{class:"text-gray-800 px-2 py-1",value:2e3+d,key:d},U(2e3+d),9,ke)),64))],544),[[_,g.value]])]),(i(),m("svg",{onClick:x,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-right cursor-pointer text-gray-200",viewBox:"0 0 16 16"},v[5]||(v[5]=[e("path",{"fill-rule":"evenodd",d:"M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"},null,-1)])))]),v[6]||(v[6]=A('<div class="weekdays flex justify-center items-center py-1" data-v-74558218><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Sun</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Mon</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Thu</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Wed</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Thu</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Fry</div><div class="mx-auto py-1 px-2 dark:text-gray-300 text-gray-500 text-sm" data-v-74558218>Sat</div></div>',1))]),e("div",Ce,[(i(!0),m(T,null,j(w.value,(d,E)=>(i(),m("div",{onClick:V=>y(E),key:E,class:R(["relative cursor-pointer rounded-md min-h-12 flex justify-between items-center p-2",{select:d.day==s.value&&!d.out,"main-gradient":M.Utils.sort(d.lessons).filter(V=>r.student==0||r.student==V.student_id).length>0}])},[e("div",{class:R(["",{"dark:text-gray-300":!d.out,"text-gray-700":!d.out,"dark:text-gray-500":d.out,"text-gray-400":d.out}])},U(d.day),3),e("div",Me,[(i(!0),m(T,null,j(M.Utils.sort(d.lessons),V=>(i(),m(T,null,[r.student==0||V.student_id==r.student?(i(),m("span",{onClick:l=>M.$emit("show",V),title:V.name,key:V.id},v[7]||(v[7]=[e("div",{class:"text-red-500"},[e("img",{src:se})],-1)]),8,Se)):Z("",!0)],64))),256))])],10,$e))),128))])]),e("div",De,[e("button",{onClick:v[2]||(v[2]=d=>M.$emit("add",s.value)),class:"rounded transition-all main-gradient flex items-center justify-center gap-4 w-full px-4 py-2 text-xs text-white mt-2"},v[8]||(v[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-person-plus-fill",viewBox:"0 0 16 16"},[e("path",{d:"M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"}),e("path",{"fill-rule":"evenodd",d:"M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5"})],-1),G(" Agregar ")])),e("div",Ve,[b.value.length>0?(i(),m("div",Ue,[(i(!0),m(T,null,j(b.value,d=>(i(),q(fe,{lesson:d,key:d.id,onEdit:E=>M.$emit("edit",d),onRemove:E=>M.$emit("remove",d)},null,8,["lesson","onEdit","onRemove"]))),128))])):(i(),m("div",Te,v[9]||(v[9]=[A('<div class="text-center" data-v-74558218><svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="rgb(107, 114, 128)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-x m-auto" data-v-74558218><path d="m13.5 8.5-5 5" data-v-74558218></path><path d="m8.5 8.5 5 5" data-v-74558218></path><circle cx="11" cy="11" r="8" data-v-74558218></circle><path d="m21 21-4.3-4.3" data-v-74558218></path></svg><p class="text-center text-gray-500" data-v-74558218>There are no classes for this day.</p></div>',1)])))])])])]))}},je=ae(Le,[["__scopeId","data-v-74558218"]]),Ne={class:"md:grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-2"},Be={class:"flex flex-col"},Ee=["value"],_e={class:"flex flex-col"},Oe=["value"],ze={class:"flex flex-col"},Ae={class:"flex flex-col"},Fe=["value"],Ye={class:"flex flex-col md:col-span-2"},He={class:"flex flex-col md:col-span-2"},Ie={class:"flex flex-col"},Re={class:"flex flex-col"},Ze={class:"mt-5 flex items-center md:col-span-2"},Je={__name:"LessonForm",props:{item:Object,students:Array,units:Array,topics:Array},emits:["send"],setup(r,{emit:p}){const f=r,$=p,w=c(!0);function s(x){$("send",x)}const b=c(new Date),k=c("08:00:00"),g=c(null),y=c(null);function L(){setTimeout(()=>{for(let x of f.topics)if(x.id==y.value){f.item.name=x.name,f.item.topic=x.topics;break}},200)}return F(()=>{let x=new Date;f.item.startdate!=null&&(x=new Date(f.item.startdate),b.value=`${x.getFullYear()}-${(x.getMonth()+1).toString().padStart(2,"0")}-${x.getDate().toString().padStart(2,"0")}`,console.log(b.value),k.value=`${x.getHours().toString().padStart(2,"0")}:${x.getMinutes().toString().padStart(2,"0")}:00`)}),(x,t)=>(i(),m("form",{id:"lesson-form",onSubmit:X(s,["prevent"]),class:"rounded-xl p-5 bg-[#aaaaaa] dark:bg-slate-900"},[e("div",Ne,[e("div",Be,[t[9]||(t[9]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"unit_id"},"Unit",-1)),D(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),"aria-label":"plan",id:"unit_id",onChange:L,class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(!0),m(T,null,j(r.units,o=>(i(),m("option",{value:o.id},U(o.name),9,Ee))),256))],544),[[_,g.value]])]),e("div",_e,[t[10]||(t[10]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"topic_id"},"Topic",-1)),D(e("select",{onChange:L,"aria-label":"plan",id:"topic_id","onUpdate:modelValue":t[1]||(t[1]=o=>y.value=o),class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(!0),m(T,null,j(r.topics.filter(o=>o.unit_id==g.value),o=>(i(),m("option",{value:o.id},U(o.name),9,Oe))),256))],544),[[_,y.value]])]),e("div",ze,[t[11]||(t[11]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"name"},"Name",-1)),D(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.item.name=o),placeholder:"",type:"text","aria-label":"Name",name:"name",id:"name",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[z,r.item.name]])]),e("div",Ae,[t[12]||(t[12]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"student_id"},"Student",-1)),D(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.item.student_id=o),"aria-label":"Student",name:"student_id",id:"student_id",class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(!0),m(T,null,j(r.students,o=>(i(),m("option",{value:o.id,key:o.id},U(o.name),9,Fe))),128))],512),[[_,r.item.student_id]])]),e("div",Ye,[t[13]||(t[13]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"topic"},"Topic",-1)),D(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=o=>r.item.topic=o),placeholder:"",type:"text","aria-label":"Topic",name:"topic",id:"topic",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[z,r.item.topic]])]),e("div",He,[t[14]||(t[14]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"zoom_link"},"Zoom Link",-1)),D(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.item.zoom_link=o),placeholder:"",type:"url","aria-label":"Zoom Link",name:"zoom_link",id:"zoom_link",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[z,r.item.zoom_link]])]),e("div",Ie,[t[15]||(t[15]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"date"},"Date",-1)),D(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>b.value=o),placeholder:"",type:"date","aria-label":"Date",name:"date",id:"date",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[z,b.value]])]),e("div",Re,[t[16]||(t[16]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"time"},"Time",-1)),D(e("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>k.value=o),placeholder:"",type:"time","aria-label":"Time",name:"time",id:"time",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[z,k.value]])]),e("p",Ze,[D(e("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>w.value=o),type:"checkbox",class:"mycheck",value:"yes",name:"notify",id:"notify"},null,512),[[Q,w.value]]),t[17]||(t[17]=e("label",{class:"ms-3 text-white font-[300] text-[1em]",for:"notify"},"Notify",-1))])]),K(x.$slots,"default")],32))}},Ge={class:"p-6"},qe={class:"flex flex-col mb-2"},Pe={value:0,key:0},We=["value"],Ke={key:0,class:"max-h-[70vh] overflow-auto custom-scroll"},Qe={class:"flex justify-end gap-2 p-4 w-full"},Xe=["disabled"],et={key:0,class:"spinner"},nt={__name:"CalendarPage",setup(r){const p=c(new Date),f=c(0),$=c(p.value.getMonth()),w=c(p.value.getFullYear()),s=c([]),b=c(0),k=c([]),g=c(!1),y=c({edit:!1,remove:!1,item:{}}),L=c([]),x=c([]);function t(l){const u=new Date;u.setDate(l),y.value.item={startdate:u.toISOString()},y.value.edit=!0}function o(l){y.value.item=JSON.parse(JSON.stringify(l)),y.value.edit=!0}async function M(l){const u=new FormData(l.target),n=y.value.item;g.value=!0;const h=u.has("notify"),C=Object.fromEntries(u.entries());C.startdate=new Date(`${C.date} ${C.time}`),delete C.date,delete C.time,delete C.notify;const S=new Date(C.startdate);S.setMinutes(S.getMinutes()-30),n.id==null?N.from("lessons").insert(C).select("*, students(*)").then(a=>{if(a.error)B.notify("Error",a.error.message,"error"),console.error("Error adding stuent:",a.error);else{const O=new Date(a.data[0].startdate);s.value[O.getDate()+Number(b.value)-1].lessons.push(a.data[0]),h&&v(a.data[0].students.email,a.data[0].students.name,a.data[0].topic,S,a.data[0].zoom_link),B.notify("Congratulations","The lesson has been added.")}g.value=!1}).catch(a=>{console.log(a),g.value=!1}):N.from("lessons").update(C).eq("id",n.id).select("*, students(*)").then(a=>{if(a.error)console.error("Error updating lesson:",a.error),B.notify("Error",a.error.message,"error");else{for(let Y of s.value)for(let J in Y.lessons)if(Y.lessons[J].id==n.id){Y.lessons.splice(J,1);break}const O=new Date(a.data[0].startdate);s.value[O.getDate()+Number(b.value)-1].lessons.push(a.data[0]),h&&v(a.data[0].students.email,a.data[0].students.name,a.data[0].topic,S,a.data[0].zoom_link),B.notify("Congratulations","Lesson's data has been updated."),g.value=!1}}).catch(()=>{g.value=!1}),y.value={edit:!1,remove:!1,item:{}}}function v(l,u,n,h,C){console.log(h);const S=new Date(h);S.setMinutes(S.getMinutes()+30);const a={email:l,subject:"Learn 24: New lesson in 30 minutes",greeting:"Hello "+u,introLines:["You have a new class with Learn 24",'The topic of the class is: "'+n+'"'],actionText:"OPEN ZOOM",actionUrl:C,displayableActionUrl:C,outroLines:["Your class starts in 30 minutes (at "+B.getDateTime(S.toString).time+")"],salutation:"Greetings",level:"success",datetime:new Date(h).toUTCString()};le.post("https://email-api.msomnium.com/api/send-mail",a).catch(()=>{B.notify("Error","An error occurred while programming the email.","error"),g.value=!1})}function d(l){g.value=!0,ee.fire({title:"Confirm",text:"Are you sure you want to delete the lesson?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"}).then(u=>{u.isConfirmed&&N.from("lessons").delete().eq("id",l.id).then(()=>{B.notify("Congratulations","The lesson has been deleted"),g.value=!1;for(let n of s.value)for(let h in n.lessons)if(n.lessons[h].id==l.id){n.lessons.splice(h,1);break}}).catch(n=>{console.error("Error deleting the item:",n),g.value=!1})})}function E(){p.value.setMonth($.value),p.value.setFullYear(w.value),V()}function V(){const l=new Date(p.value.getFullYear(),p.value.getMonth(),p.value.getDate()),u=l.getMonth()+1,n=l.getFullYear();N.from("lessons").select("*, students(*)").gte("startdate",`${n}-${u.toString().padStart(2,"0")}-01`).lt("startdate",`${n}-${(u+1).toString().padStart(2,"0")}-01`).then(h=>{if(h.error){console.error("Error fetching lessons:",h.error);return}s.value=[],l.setDate(1);const C=new Date(l.toISOString());C.setDate(0);for(let a=1;a<l.getDay()+1;a++)s.value.push({day:C.getDate()-a+1,out:!0});b.value=s.value.length,l.setMonth(l.getMonth()+1),l.setDate(0);for(let a=1;a<l.getDate()+1;a++)s.value.push({day:a,lessons:[],color:"text-black"});console.log(h);for(let a of h.data){const O=new Date(a.startdate);s.value[O.getDate()-1+b.value].lessons.push(a)}const S=new Date(l.toISOString());S.setDate(1),S.setMonth(l.getMonth()+1);for(let a=1;a<8-(l.getDay()+1);a++)s.value.push({day:S.getDate()+a-1,out:!0})}).catch(h=>{console.log("Error fetching lessons:",h)})}return F(()=>{V(),N.from("students").select("*").then(l=>{k.value=l.data}).catch(l=>{console.console.log(l)}),N.from("units").select("*").then(l=>{L.value=l.data}),N.from("topics").select("*").then(l=>{x.value=l.data})}),(l,u)=>(i(),q(te,null,{default:H(()=>[e("div",Ge,[e("div",qe,[D(e("select",{"onUpdate:modelValue":u[0]||(u[0]=n=>f.value=n),"aria-label":"Student",name:"student_id",id:"student_id",class:"select-dark custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},[(i(),m("option",Pe," All students ")),(i(!0),m(T,null,j(k.value,n=>(i(),m("option",{value:n.id,key:n.id},U(n.name),9,We))),128))],512),[[_,f.value]])]),I(je,{today:p.value,day:s.value,student:f.value,onUpdate:E,onAdd:t,onEdit:o,onRemove:d,onYear:u[1]||(u[1]=n=>w.value=n),onShow:u[2]||(u[2]=n=>l.details=n),onMonth:u[3]||(u[3]=n=>$.value=n)},null,8,["today","day","student"])]),I(oe,{modelValue:y.value.edit,"onUpdate:modelValue":u[4]||(u[4]=n=>y.value.edit=n),title:y.value.item.id==null?"Add lesson":"Edit lesson",subtitle:y.value.item.id==null?"Complete the form to add a new lesson":"Complete the form to update lesson data"},{footer:H(()=>[e("div",Qe,[e("button",{form:"lesson-form",type:"submit",disabled:g.value,class:"duration-300 px-4 disabled:opacity-80 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[g.value?(i(),m("div",et)):Z("",!0),u[5]||(u[5]=G(" Save "))],8,Xe)])]),default:H(()=>[y.value.edit?(i(),m("div",Ke,[I(Je,{item:y.value.item,students:k.value,units:L.value,topics:x.value,onSend:M},null,8,["item","students","units","topics"])])):Z("",!0)]),_:1},8,["modelValue","title","subtitle"])]),_:1}))}};export{nt as default};
