import{M as U}from"./MainLayout-9wRzYlNW.js";import{c as g,o as m,a as t,j as A,f as S,k as E,w as T,m as j,r as d,g as $,s as p,h as z,i as h,n as w,d as _,e as M,t as C,z as L,U as u,S as D}from"./index-BVeZGJWa.js";import{_ as O}from"./TableComponent-BYphbJy_.js";import{M as P}from"./ModalComponent-eCPLUFrI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"md:grid grid-cols-1 gap-x-6 gap-y-2"},W={class:"flex flex-col"},q={__name:"UnitForm",props:{item:Object},emits:["send"],setup(b,{emit:x}){const y=x;function o(n){y("send",n)}return(n,i)=>(m(),g("form",{id:"unit-form",onSubmit:T(o,["prevent"]),class:"rounded-xl p-5 bg-[#aaaaaa] dark:bg-slate-900"},[t("div",H,[t("div",W,[i[1]||(i[1]=t("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"name"},"Name",-1)),S(t("input",{"onUpdate:modelValue":i[0]||(i[0]=c=>b.item.name=c),placeholder:"",type:"text","aria-label":"Name",name:"name",id:"name",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[E,b.item.name]])])]),A(n.$slots,"default")],32))}},F={class:"p-6"},J=["disabled"],Y={key:0,class:"spinner"},Z={class:"table-row"},G={class:"text-gray-800 dark:text-gray-200"},I={class:"text-gray-800 dark:text-gray-200"},K={class:"text-gray-800 dark:text-gray-200"},Q={class:"flex gap-2 items-center"},R=["onClick"],X=["onClick"],ee={key:0,class:"max-h-[70vh] overflow-auto custom-scroll"},te={class:"flex justify-end gap-2 p-4 w-full"},ae=["disabled"],oe={key:0,class:"spinner"},de={__name:"UnitsPage",setup(b){const x=j(()=>[{name:"#",minWidth:10},{name:"Name",value:r=>r.name,minWidth:250},{name:"Created at",minWidth:100},{name:"Actions",hidden:!0,minWidth:20}]),y=d(x),o=d(!1),n=d([]),i=d(1),c=d(5),k=d(""),s=d({edit:!1,remove:!1,item:{}});function V(){s.value.item={},s.value.edit=!0}async function B(r){const a=new FormData(r.target),e=s.value.item;o.value=!0;const f=Object.fromEntries(a.entries());e.id==null?p.from("units").insert(f).select().then(l=>{l.error?(u.notify("Error",l.error.message,"error"),console.error("Error adding stuent:",l.error)):(n.value.unshift(l.data[0]),u.notify("Congratulations","The unit has been added."))}):p.from("units").update(f).eq("id",e.id).select().then(l=>{if(l.error)console.error("Error updating user:",l.error),u.notify("Error",l.error.message,"error");else for(let v in n.value)if(n.value[v].id==e.id){n.value[v]=l.data[0],u.notify("Congratulations","Unit's data has been updated.");break}}),s.value={edit:!1,remove:!1,item:{}},o.value=!1}function N(r){o.value=!0,D.fire({title:"Confirm",text:"Are you sure you want to delete the unit?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"}).then(a=>{a.isConfirmed&&p.from("units").delete().eq("id",r.id).then(()=>{u.notify("Congratulations","The unit has been deleted"),o.value=!1;for(let e in n.value)if(n.value[e].id==r.id){n.value.splice(e,1);break}}).catch(e=>{console.error("Error deleting the item:",e),o.value=!1})})}return $(()=>{o.value=!0,p.from("units").select("*").then(r=>{n.value=r.data,o.value=!1}).catch(r=>{o.value=!1,console.console.log(r)})}),(r,a)=>(m(),z(U,null,{default:h(()=>[t("div",F,[t("button",{disabled:o.value,onClick:V,class:"duration-300 px-4 disabled:opacity-80 mb-2 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[o.value?(m(),g("div",Y)):_("",!0),a[4]||(a[4]=M(" Add unit "))],8,J),w(O,{columns:y.value,items:n.value,page:i.value,"onUpdate:page":a[0]||(a[0]=e=>i.value=e),"items-per-page":c.value,"onUpdate:itemsPerPage":a[1]||(a[1]=e=>c.value=e),modelValue:k.value,"onUpdate:modelValue":a[2]||(a[2]=e=>k.value=e)},{row:h(({item:e,index:f,internal:l})=>[t("tr",Z,[t("td",G,C(Number(f)+1),1),t("td",I,C(e.name),1),t("td",K,C(L(u).toDateTimeText(e.created_at)),1),t("td",null,[t("div",Q,[t("button",{onClick:v=>s.value={edit:!0,remove:!1,item:JSON.parse(JSON.stringify(e))},class:"bg-transparent transition-all text-orange-400 hover:text-orange-600 hover:scale-125 p-1 border-none focus:border-none"},a[5]||(a[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil-square",viewBox:"0 0 16 16"},[t("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),t("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"})],-1)]),8,R),t("button",{onClick:v=>N(e),class:"bg-transparent transition-all text-red-400 hover:text-red-600 hover:scale-125 p-1 border-none focus:border-none"},a[6]||(a[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash3",viewBox:"0 0 16 16"},[t("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"})],-1)]),8,X)])])])]),_:1},8,["columns","items","page","items-per-page","modelValue"]),w(P,{modelValue:s.value.edit,"onUpdate:modelValue":a[3]||(a[3]=e=>s.value.edit=e),title:s.value.item.id==null?"Add unit":"Edit unit",subtitle:s.value.item.id==null?"Complete the form to add a new unit":"Complete the form to update unit data"},{footer:h(()=>[t("div",te,[t("button",{form:"unit-form",type:"submit",disabled:o.value,class:"duration-300 px-4 disabled:opacity-80 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[o.value?(m(),g("div",oe)):_("",!0),a[7]||(a[7]=M(" Save "))],8,ae)])]),default:h(()=>[s.value.edit?(m(),g("div",ee,[w(q,{item:s.value.item,onSend:B},null,8,["item"])])):_("",!0)]),_:1},8,["modelValue","title","subtitle"])])]),_:1}))}};export{de as default};
