import{c as g,o as b,a as e,k as $,f as x,l as y,w as U,n as j,r as c,g as F,s as p,h as H,i as w,j as T,F as O,y as W,t as v,d as k,e as V,z as D,U as f,S as N}from"./index-Cz9qMU4q.js";import{_ as z}from"./offers-BhP4Cafp.js";import{M as P}from"./MainLayout-CEmonEtD.js";import{_ as q}from"./TableComponent-B8pkeUEz.js";import{M as I}from"./ModalComponent-BVjXJSti.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"md:grid grid-cols-1 gap-x-6 gap-y-2"},Y={class:"flex flex-col"},Z={class:"flex flex-col"},G={class:"flex flex-col"},K={class:"flex flex-col"},Q={__name:"OfferForm",props:{item:Object},emits:["send"],setup(u,{emit:_}){const C=_;function o(s){C("send",s)}return(s,r)=>(b(),g("form",{id:"offer-form",onSubmit:U(o,["prevent"]),class:"rounded-xl p-5 bg-[#aaaaaa] dark:bg-slate-900"},[e("div",J,[e("div",Y,[r[4]||(r[4]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"image"}," Image (Link) ",-1)),x(e("input",{"onUpdate:modelValue":r[0]||(r[0]=d=>u.item.image=d),placeholder:"",type:"text","aria-label":"Image",name:"image",id:"image",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[y,u.item.image]])]),e("div",Z,[r[5]||(r[5]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"title"},"Title",-1)),x(e("input",{"onUpdate:modelValue":r[1]||(r[1]=d=>u.item.title=d),placeholder:"",type:"text","aria-label":"Title",name:"title",id:"title",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[y,u.item.title]])]),e("div",G,[r[6]||(r[6]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"features"},"Features (1 per line)",-1)),x(e("textarea",{"onUpdate:modelValue":r[2]||(r[2]=d=>u.item.features=d),placeholder:"",type:"text","aria-label":"Features",name:"features",id:"features",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[y,u.item.features]])]),e("div",K,[r[7]||(r[7]=e("label",{class:"text-gray-800 dark:text-gray-200 mb-1",for:"content"},"Content (1 per line)",-1)),x(e("textarea",{"onUpdate:modelValue":r[3]||(r[3]=d=>u.item.content=d),placeholder:"",type:"text","aria-label":"Content",name:"content",id:"content",class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,512),[[y,u.item.content]])])]),$(s.$slots,"default")],32))}},R={class:"p-6"},X={class:"grid grid-cols-3 gap-2"},ee={class:"flex flex-col"},te={class:"text-gray-800 dark:text-gray-200 mb-1",for:"title"},ae=["onUpdate:modelValue","name","id"],oe={class:"flex justify-between gap-2"},re=["disabled"],le={key:0,class:"spinner"},ne=["disabled"],se={key:0,class:"spinner"},ie={class:"table-row"},de={class:"text-gray-800 dark:text-gray-200"},ue={class:"text-gray-800 dark:text-gray-200"},me=["src"],ce={class:"text-gray-800 dark:text-gray-200"},fe={class:"text-gray-800 dark:text-gray-200"},be=["innerHTML"],ge=["innerHTML"],pe={class:"text-gray-800 dark:text-gray-200"},ve={class:"flex gap-2 items-center"},xe=["onClick"],ye=["onClick"],he={key:0,class:"max-h-[70vh] overflow-auto custom-scroll"},we={class:"flex justify-end gap-2 p-4 w-full"},ke=["disabled"],_e={key:0,class:"spinner"},Le={__name:"OffersPage",setup(u){const _=j(()=>[{name:"#",minWidth:10},{name:"Image",minWidth:50},{name:"Title",value:l=>l.title.toString(),minWidth:120},{name:"Description",value:l=>l.description.toString(),minWidth:200},{name:"Features",value:l=>l.features.toString(),minWidth:300},{name:"Content",value:l=>l.content.toString(),minWidth:700},{name:"Created at",minWidth:100},{name:"Actions",minWidth:20}]),C=c(_),o=c(!1),s=c([]),r=c([]),d=c(1),M=c(5),S=c(""),i=c({edit:!1,remove:!1,item:{}});function L(){i.value.item={},i.value.edit=!0}async function A(l){const a=new FormData(l.target),t=i.value.item;o.value=!0;const m=Object.fromEntries(a.entries());t.id==null?p.from("courses").insert(m).select().then(n=>{n.error?(f.notify("Error",n.error.message,"error"),console.error("Error adding stuent:",n.error)):(s.value.unshift(n.data[0]),f.notify("Congratulations","The offer has been added."))}):p.from("courses").update(m).eq("id",t.id).select().then(n=>{if(n.error)console.error("Error updating feature:",n.error),f.notify("Error",n.error.message,"error");else for(let h in s.value)if(s.value[h].id==t.id){s.value[h]=n.data[0],f.notify("Congratulations","Offer's data has been updated.");break}}),i.value={edit:!1,remove:!1,item:{}},o.value=!1}async function B(l){const a=new FormData(l.target);o.value=!0;try{for(const[t,m]of a.entries()){const{error:n}=await p.from("texts").update({content:m}).eq("id",t);n&&(console.error("Error updating feature:",n),f.notify("Error",n.message,"error"))}}catch(t){console.error("Unexpected error:",t),f.notify("Error","Unexpected error occurred","error")}o.value=!1}function E(l){o.value=!0,N.fire({title:"Confirm",text:"Are you sure you want to delete the offer?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it",cancelButtonText:"Cancel"}).then(a=>{a.isConfirmed&&p.from("courses").delete().eq("id",l.id).then(()=>{f.notify("Congratulations","The offer has been deleted"),o.value=!1;for(let t in s.value)if(s.value[t].id==l.id){s.value.splice(t,1);break}}).catch(t=>{console.error("Error deleting the item:",t),o.value=!1})})}return F(()=>{o.value=!0,p.from("texts").select("*").then(l=>{r.value=l.data,p.from("courses").select("*").then(a=>{s.value=a.data,o.value=!1}).catch(a=>{console.log(a),o.value=!1})}).catch(l=>{console.log(l),o.value=!1})}),(l,a)=>(b(),H(P,null,{default:w(()=>[e("div",R,[a[9]||(a[9]=e("img",{src:z,class:"w-full rounded-lg mb-4"},null,-1)),e("form",{onSubmit:U(B,["prevent"]),class:"mb-4"},[e("div",X,[(b(!0),g(O,null,W(r.value.filter(t=>t.type=="five"),t=>(b(),g("div",ee,[e("label",te,"Text "+v(t.index),1),x(e("input",{"onUpdate:modelValue":m=>t.content=m,placeholder:"",type:"text","aria-label":"Title",name:t.id,id:t.id,class:"custom-autocomplete text-[#009688] placeholder:text-gray-500 transition-all outline-none focus:outline-none border border-[#797979] dark:border-[#1b2e4b] focus:border-gray-600 px-5 py-3 rounded-md bg-[#ebedf07a] dark:bg-[#1b2e4b] w-full mb-4"},null,8,ae),[[y,t.content]])]))),256))]),e("div",oe,[e("button",{type:"submit",disabled:o.value,class:"duration-300 px-4 disabled:opacity-80 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[o.value?(b(),g("div",le)):k("",!0),a[4]||(a[4]=V(" Save "))],8,re),e("button",{disabled:o.value,onClick:L,type:"button",class:"duration-300 px-4 disabled:opacity-80 mb-2 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[o.value?(b(),g("div",se)):k("",!0),a[5]||(a[5]=V(" Add plan "))],8,ne)])],32),T(q,{columns:C.value,items:s.value,page:d.value,"onUpdate:page":a[0]||(a[0]=t=>d.value=t),"items-per-page":M.value,"onUpdate:itemsPerPage":a[1]||(a[1]=t=>M.value=t),modelValue:S.value,"onUpdate:modelValue":a[2]||(a[2]=t=>S.value=t)},{row:w(({item:t,index:m,internal:n})=>[e("tr",ie,[e("td",de,v(Number(m)+1),1),e("td",ue,[e("img",{src:t.image,class:"w-10"},null,8,me)]),e("td",ce,v(t.title),1),e("td",fe,v(t.description),1),e("td",{class:"text-gray-800 dark:text-gray-200",innerHTML:t.features.replaceAll(`
`,"<br />")},null,8,be),e("td",{class:"text-gray-800 dark:text-gray-200",innerHTML:t.content.replaceAll(`
`,"<br />")},null,8,ge),e("td",pe,v(D(f).toDateTimeText(t.created_at)),1),e("td",null,[e("div",ve,[e("button",{onClick:h=>i.value={edit:!0,remove:!1,item:JSON.parse(JSON.stringify(t))},class:"bg-transparent transition-all text-orange-400 hover:text-orange-600 hover:scale-125 p-1 border-none focus:border-none"},a[6]||(a[6]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil-square",viewBox:"0 0 16 16"},[e("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),e("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"})],-1)]),8,xe),e("button",{onClick:h=>E(t),class:"bg-transparent transition-all text-red-400 hover:text-red-600 hover:scale-125 p-1 border-none focus:border-none"},a[7]||(a[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash3",viewBox:"0 0 16 16"},[e("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"})],-1)]),8,ye)])])])]),_:1},8,["columns","items","page","items-per-page","modelValue"]),T(I,{modelValue:i.value.edit,"onUpdate:modelValue":a[3]||(a[3]=t=>i.value.edit=t),title:i.value.item.id==null?"Add offer":"Edit offer",subtitle:i.value.item.id==null?"Complete the form to add a new offer":"Complete the form to update offer data"},{footer:w(()=>[e("div",we,[e("button",{form:"offer-form",type:"submit",disabled:o.value,class:"duration-300 px-4 disabled:opacity-80 transition-transform flex gap-2 justify-center items-center bg-[#058beb] text-white py-[0.4rem] rounded-md shadow-lg shadow-[#00000060] hover:translate-y-[-0.2rem]"},[o.value?(b(),g("div",_e)):k("",!0),a[8]||(a[8]=V(" Save "))],8,ke)])]),default:w(()=>[i.value.edit?(b(),g("div",he,[T(Q,{item:i.value.item,onSend:A},null,8,["item"])])):k("",!0)]),_:1},8,["modelValue","title","subtitle"])])]),_:1}))}};export{Le as default};
